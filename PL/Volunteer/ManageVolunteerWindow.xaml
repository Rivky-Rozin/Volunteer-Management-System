<Window x:Class="PL.Volunteer.ManageVolunteerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:pl="clr-namespace:PL"
        Title="VolunteerWindow" Height="700" Width="540"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}">
    <Window.Resources>
        <pl:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
    </Window.Resources>
    <ScrollViewer VerticalScrollBarVisibility="Auto" Background="{StaticResource WindowBackgroundBrush}">
        <StackPanel Margin="0,18,0,18" HorizontalAlignment="Center">
            <!-- כותרת -->
            <TextBlock Text="ניהול מתנדב" FontSize="26" FontWeight="SemiBold" Margin="0,0,0,18" HorizontalAlignment="Center"/>

            <!-- פרטי מתנדב -->
            <Border Background="{StaticResource SurfaceBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="6" Padding="18" Margin="0,0,0,18" Width="440">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="מזהה:"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding CurrentVolunteer.Id}" IsReadOnly="{Binding ButtonText, Converter={StaticResource ConvertUpdateToTrueKey}}"/>

                    <Label Grid.Row="1" Grid.Column="0" Content="שם:"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding CurrentVolunteer.Name, Mode=TwoWay}" />

                    <Label Grid.Row="2" Grid.Column="0" Content="טלפון:"/>
                    <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding CurrentVolunteer.Phone, Mode=TwoWay}" />

                    <Label Grid.Row="3" Grid.Column="0" Content="אימייל:"/>
                    <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding CurrentVolunteer.Email, Mode=TwoWay}" />

                    <Label Grid.Row="4" Grid.Column="0" Content="סיסמה:"/>
                    <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding CurrentVolunteer.Password, Mode=TwoWay}" />

                    <Label Grid.Row="5" Grid.Column="0" Content="כתובת:"/>
                    <TextBox Grid.Row="5" Grid.Column="1" Text="{Binding CurrentVolunteer.Address, Mode=TwoWay}" />

                    <Label Grid.Row="6" Grid.Column="0" Content="קו רוחב:"/>
                    <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding CurrentVolunteer.Latitude, Mode=TwoWay}" />

                    <Label Grid.Row="7" Grid.Column="0" Content="קו אורך:"/>
                    <TextBox Grid.Row="7" Grid.Column="1" Text="{Binding CurrentVolunteer.Longitude, Mode=TwoWay}" />

                    <Label Grid.Row="8" Grid.Column="0" Content="תפקיד:"/>
                    <ComboBox Grid.Row="8" Grid.Column="1"
                              ItemsSource="{Binding Source={StaticResource VolunteerRoleCollectionKey}}"
                              SelectedItem="{Binding CurrentVolunteer.Role, Mode=TwoWay}" />

                    <Label Grid.Row="9" Grid.Column="0" Content="פעיל:"/>
                    <CheckBox Grid.Row="9" Grid.Column="1" IsChecked="{Binding CurrentVolunteer.IsActive, Mode=TwoWay}" />

                    <Label Grid.Row="10" Grid.Column="0" Content="מרחק מקסימלי:"/>
                    <TextBox Grid.Row="10" Grid.Column="1" Text="{Binding CurrentVolunteer.MaxDistance, Mode=TwoWay}" />

                    <Label Grid.Row="11" Grid.Column="0" Content="סוג מרחק:"/>
                    <ComboBox Grid.Row="11" Grid.Column="1"
                              ItemsSource="{Binding Source={StaticResource DistanceKindCollectionKey}}"
                              SelectedItem="{Binding CurrentVolunteer.DistanceKind, Mode=TwoWay}" />

                    <Label Grid.Row="12" Grid.Column="0" Content="קריאות שטופלו:"/>
                    <TextBox Grid.Row="12" Grid.Column="1" Text="{Binding CurrentVolunteer.HandledCallsCount}" IsReadOnly="True"/>

                    <Label Grid.Row="13" Grid.Column="0" Content="קריאות שבוטלו:"/>
                    <TextBox Grid.Row="13" Grid.Column="1" Text="{Binding CurrentVolunteer.CancelledCallsCount}" IsReadOnly="True"/>

                    <Label Grid.Row="14" Grid.Column="0" Content="קריאות שטופלו באיחור:"/>
                    <TextBox Grid.Row="14" Grid.Column="1" Text="{Binding CurrentVolunteer.ExpiredHandledCallsCount}" IsReadOnly="True"/>
                </Grid>
            </Border>

            <!-- קריאה פעילה -->
            <Border Background="{StaticResource PanelBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="6" Padding="14" Margin="0,0,0,18" Width="440"
                    Visibility="{Binding CurrentVolunteer.CallInProgress, Converter={StaticResource NullToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="קריאה פעילה" FontWeight="Bold" FontSize="18" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="מזהה קריאה: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.CallId}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="סוג קריאה: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.CallType}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="תיאור: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.Description}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="כתובת: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.FullAddress}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="זמן פתיחה: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.OpenTime}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="זמן יעד לסיום: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.MaxResolutionTime}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="כניסה לטיפול: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.EntryToTreatmentTime}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="מרחק מהמתנדב: " FontWeight="Bold" Width="110"/>
                        <TextBlock Text="{Binding CurrentVolunteer.CallInProgress.DistanceFromVolunteer, StringFormat='{}{0:F1} קמ'}"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- כפתור הוספה/עדכון -->
            <Button Content="{Binding ButtonText}" Click="btnAddUpdate_Click" Width="180" Height="44" HorizontalAlignment="Center"/>
        </StackPanel>
    </ScrollViewer>
</Window>
